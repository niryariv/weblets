{% extends "../layout.html" %}

	{% block head %}
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js" type="text/javascript"></script>
	<script src="/static/js/jquery.textarea.js" type="text/javascript"></script>
	<script>
		

	function save() {
		$.post('/_source/{{script.name}}', { code: $("#code").val(), docs: $("#docs").val(), _method: 'put', format: 'xhr'});
	}
	
	$(document).ready(function(){
		
		// enable tabs inside textareas
		$("textarea").tabby();
		
		// save docs & code
		$("#save").click(function (){
			save();
		});

		// save and execute
		$("#run").click(function () { 
			save();
			window.location = "/{{script.name}}"
		});

	});

	</script>
	{% endblock %}
	
	{% block body %}

<form action="/_source/{{script.name}}" method="post" name="info">
	
	<table width="100%" border="0" cellpadding="0"> <!-- free yourselves from CSS! -->
		<tr>
			<td align="right">
				<h2>Source for <tt>{{script.name}}</tt></h2>
				<input type="hidden" name="_method" value="put" />
				<textarea name="code" id="code" cols="75" rows="30" {% if not can_edit %} readonly="readonly" {% endif %}>{{script.code}}</textarea>
			</td>
			<td align="center">
				{% if can_edit %}<input type="button" value="Save" id="save" />{% endif %}
				<br /><br />
				<input type="button" value="Run" id="run" />
			</td>
			<td>
				<h2><tt>{{script.name}}</tt> Docs</h2>
				<textarea name="docs" id="docs" cols="75" rows="30" {% if not can_edit %} readonly="readonly" {% endif %}>{{script.docs}}</textarea>
			</td>
		</td>
	</table>
	
</form>
{% endblock %}